---
description: Scan for leaked secrets on file modification
globs: '**/*'
alwaysApply: true
---
# Secrets Detection Rule
Whenever a file is modified in the repository:
1. Run the MCP server function `mcp_endor-cli-tools_scan` with scan_types of `["secrets"]` and set the path parameter to the root of the repository.
2. If any secrets are detected:
  - Ignore the finding if the file or path is included in the `.gitignore` or `.dockerignore` file
  - Move the secret to a more appropriate location, such as an environment variable. Be sure to update the README if there is one.
  - Re-scan to verify the secret has been properly removed.
3. If the scan fails due to host-check or other issues, note the failure but continue with the task.