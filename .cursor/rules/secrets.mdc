---
description: Scan for leaked secrets on file modification
globs: '**/*'
alwaysApply: true
---
# Leaked Secrets Detection Rule
Whenever a file is modified in the repository:
1. Run `endor-cli-tools` using the `scan` tool with scan_types of `secrets` and set the path parameter to the root of the repository.
2. If any secrets are detected:
  - Ignore the finding if the file or path is included in the `.gitignore` or `.dockerignore` file
  - Move the secret to a more appropriate location, such as an environment variable. Be sure to update the README if there is one.
  - Re-scan to verify the secret has been properly removed.