---
description: Scan for leaked secrets on file modification
globs: '**/*'
alwaysApply: true
---
# Leaked Secrets Detection Rule
Whenever a file is modified in the repository:
- Run `endor-cli-tools` using the `scan` tool with scan_types of `secrets` on the modified source files. Always set the path parameter to the root of the repository.
- If any secrets are detected:
  - Ignore the finding if the file or path is included in the `.gitignore` or `.dockerignore` file
  - Move the secret to a more appropriate location, such as an environment variable.
  - Re-scan to verify the secret has been properly removed.